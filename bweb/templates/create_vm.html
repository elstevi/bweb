<script type='text/javascript'>
    var networkcnt = 0;
    var diskcnt = 0;
    function addNetwork(){
        var newdiv = document.createElement('div');
	    newdiv.style.border = "1px solid black";
	    newdiv.style.padding = "10px";
	    var title = document.createElement('h3')
	        title.innerHTML = "Network " + networkcnt
	    var bridgeno_label = document.createElement('label');
	        bridgeno_label.innerHTML = "bridge: ";
            var bridgeno = document.createElement('input');
	        bridgeno.name = "net_" + networkcnt + "_bridge";
	    var mac_label = document.createElement('label');
	        mac_label.innerHTML = "mac: ";
            var mac = document.createElement('input');
	        mac.value       = "auto";
	        mac.name = "net_" + networkcnt + "_mac";
	    var driver_label = document.createElement('label');
	        driver_label.innerHTML = "driver: ";
            var driver = document.createElement('select');
{% for v in NIC_TYPES %}
            var {{NIC_TYPES[v]['short']}} = new Option();
                {{NIC_TYPES[v]['short']}}.text  = "{{NIC_TYPES[v]['name']}} - {{NIC_TYPES[v]['description']}}";
                {{NIC_TYPES[v]['short']}}.value = "{{NIC_TYPES[v]['name']}}";
                driver.options.add({{NIC_TYPES[v]['short']}});
	        driver.name = "net_" + networkcnt + "_driver";
{% endfor %}
	    var deletenetwork = document.createElement('a');
	        deletenetwork.href = '#';
	        deletenetwork.innerHTML = "Delete network";
	    deletenetwork.onclick = function(){this.parentElement.remove();}
	newdiv.appendChild(title);
	newdiv.appendChild(bridgeno_label);
	newdiv.appendChild(bridgeno);
	newdiv.appendChild(document.createElement('br'));

	newdiv.appendChild(mac_label);
	newdiv.appendChild(mac);
	newdiv.appendChild(document.createElement('br'));

	newdiv.appendChild(driver_label);
	newdiv.appendChild(driver);
	newdiv.appendChild(document.createElement('br'));

	newdiv.appendChild(deletenetwork);
        document.getElementById('net-bucket').appendChild(newdiv);
	networkcnt++;
    }
    function addDisk(){
        var newdiv = document.createElement('div');
	    newdiv.style.border = "1px solid black";
	    newdiv.style.padding = "10px";
	    var title = document.createElement('h3')
	        title.innerHTML = "Disk " + diskcnt
	    var path_label = document.createElement('label');
	        path_label.innerHTML = "path: ";
            var path = document.createElement('input');
	        path.name = "dsk_" + diskcnt + "_path";
	    var size_label = document.createElement('label');
	        size_label.innerHTML = "size: ";
            var size = document.createElement('input');
	        size.name = "dsk_" + diskcnt + "_size"
	    var driver_label = document.createElement('label');
	        driver_label.innerHTML = "driver: ";
            var driver = document.createElement('select');
{% for v in DISK_TYPES %}
            var {{DISK_TYPES[v]['short']}} = new Option();
                {{DISK_TYPES[v]['short']}}.text  = "{{DISK_TYPES[v]['name']}} - {{DISK_TYPES[v]['description']}}";
                {{DISK_TYPES[v]['short']}}.value = "{{DISK_TYPES[v]['name']}}";
                driver.options.add({{DISK_TYPES[v]['short']}});
	        driver.name = "dsk_" + diskcnt + "_driver";
{% endfor %}
	    var backing_label = document.createElement('label');
	        backing_label.innerHTML = "backing: ";
            var backing = document.createElement('select');
{% for v in BACKING_TYPES %}
            var {{BACKING_TYPES[v]['short']}} = new Option();
                {{BACKING_TYPES[v]['short']}}.text  = "{{BACKING_TYPES[v]['name']}} - {{BACKING_TYPES[v]['description']}}";
                {{BACKING_TYPES[v]['short']}}.value = "{{BACKING_TYPES[v]['name']}}";
                backing.options.add({{BACKING_TYPES[v]['short']}});
	        backing.name = "dsk_" + diskcnt + "_backing";
{% endfor %}
	    var create_disk_label = document.createElement('label');
	        create_disk_label.innerHTML = "create disks?: "
            var create_disk = document.createElement('select');
            var yes = new Option();
                yes.text  = "yes";
                yes.value = "yes";
                create_disk.options.add(yes);
            var no = new Option();
                no.text  = "no";
                no.value = "no";
                create_disk.options.add(no);
	        create_disk.name = "dsk_" + diskcnt + "_create_disk";
	    var deletedisk = document.createElement('a');
	        deletedisk.href = '#';
	        deletedisk.innerHTML = "Delete disk";
	    deletedisk.onclick = function(){this.parentElement.remove();}

	newdiv.appendChild(title);
	newdiv.appendChild(path_label);
	newdiv.appendChild(path);
	newdiv.appendChild(document.createElement('br'));

	newdiv.appendChild(size_label);
	newdiv.appendChild(size);
	newdiv.appendChild(document.createElement('br'));

	newdiv.appendChild(driver_label);
	newdiv.appendChild(driver);
	newdiv.appendChild(document.createElement('br'));

	newdiv.appendChild(backing_label);
	newdiv.appendChild(backing);
	newdiv.appendChild(document.createElement('br'));

	newdiv.appendChild(create_disk_label);
	newdiv.appendChild(create_disk);
	newdiv.appendChild(document.createElement('br'));

	newdiv.appendChild(deletedisk);
        document.getElementById('disk-bucket').appendChild(newdiv);
	diskcnt++;
    }
</script>

<h1>Create VM</h1>
<body>
	<form method='POST' action='/vm/create'>
		<label>vm name:</label>
		<input name="name" type="text"/><br/>

		<label>cpus:</label>
		<input name="ncpus" type="text"/><br/>

		<label>memory:</label>
		<input name="memory" type="text"/><br/>

		<label>onboot:</label>
		<select name="auto_start">
			<option value="True">Yes</option>
			<option value="False">No</option>
		</select><br/>

		<label>iso:</label>
		<input name="iso" type="text"/><br/>

		<div style="border: 1px solid black; padding: 10px;" id='net-bucket'>
			<h2>Networks</h2>
		</div>
	        <a href="#" onclick="addNetwork();">Add network</a><br/>

		<div style="border: 1px solid black; padding: 10px;" id='disk-bucket'>
			<h2>Disks</h2>
		</div>
		<a href="#" onclick="addDisk();">Add disk</a><br/>

		<label>hypervisor:</label>
		<select name="host">
			{% for host in hosts %}
			<option value="{{host}}">{{host}}</option>
			{% endfor %}
		</select><br/>

                <input type="submit" value="Create"/>
	</form>
</body>
